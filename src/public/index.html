<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <link rel="icon" href="images/tl.webp" type="image/png">
    <title>Agência de Projetos de Inovação do IFNMG Salinas</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="https://kit.fontawesome.com/915b45d802.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

</head>

<body>

    <!------------------Home--------------->
    <div class="container">
        <div id="header">
            <nav>
                <img src="images/tl.webp" class="logo">
                <ul id="sidemenu">
                    <li><a href="https://portifolio-projetos-ifnmg-salinas.vercel.app/#header">Sobre</a></li>
                    <li><a href="https://portifolio-projetos-ifnmg-salinas.vercel.app/#about">Projetos</a></li>
                    <li><a href="/livros">Livros</a></li>
                    <li><a href="/artigos">Artigos</a></li>
                    <li><a href="https://portifolio-projetos-ifnmg-salinas.vercel.app/#contact">Contato</a></li>
                    <i class="fa-solid fa-circle-xmark" onclick="clossmenu()"></i>
                </ul>
                <img src="images/salinas_vertical_jpg (1).jpg" class="logoIFNMG">
                <i class="fa-solid fa-bars" onclick="openmenu()"></i>
            </nav>
            <div class="header-text">
                <h1 style="color: black">Olá, <span>Bem vindo ao portifolio</span></h1>
            </div>
            <div class="row">
                <div class="about-col-1">
                    <img src="images/a2.png">
                </div>
                <div class="sobre">
                    <h1 class="sub-title">Sobre</h1>

                    <h1>Objetivo do Projeto "Agência de Projetos de Inovação do IFNMG"</h1>

                    <p>
                        O principal objetivo do projeto, conforme detalhado no Edital Nº 587, é fortalecer o
                        ecossistema
                        de inovação na área de abrangência do Instituto Federal do Norte de Minas Gerais (IFNMG) por
                        meio do desenvolvimento de sua Agência de Projetos de Inovação.
                        </br>
                        Com uma duração de 48 meses, o projeto visa atender às demandas de inovação e extensão
                        tecnológica da região. Para isso, ele está estruturado em cinco pilares fundamentais:
                    </p>

                    <ul>
                        <li>Valoração de Tecnologia</li>
                        <li>Criação de Hubs de Inovação</li>
                        <li>Agenciamento de Tecnologias e Competências para prospecção de parcerias</li>
                        <li>Apoio ao Inventor Independente</li>
                        <li>Gestão dos Ambientes de Inovação</li>
                    </ul>
                </div>
            </div>
        </div>
        <div id="about">
            <div class="row">
                <div class="port1">
                    <h1 class="sub-title">Projetos</h1>
                    <p style="background-color: rgba(255, 255, 255, 0.05); 
           color: black; 
           font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
           font-size: 16px; 
           line-height: 1.7; 
           padding: 25px; 
           border-left: 5px solid #28a745; 
           border-radius: 5px; 
           box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);">
                        No IFNMG - Campus Salinas, a pesquisa científica não fica só na teoria. Nossos projetos são
                        desenvolvidos para resolver os problemas reais do produtor rural e das empresas do Norte de
                        Minas. Conectamos diretamente nossos laboratórios com as demandas do campo, criando soluções
                        práticas para a agropecuária, a tecnologia de alimentos e o meio ambiente. Nosso foco é gerar
                        inovação aplicada que fortalece a economia local. É a ciência saindo do papel e transformando a
                        realidade da nossa região.
                    </p>
                    </br>
                    <p></p>
                    <div>
                        <form id="portifolio-filter-form">
                            <select id="tematica-select">
                                <option value="">Todas as Temáticas</option>
                            </select>
                            <select id="coordenador-select">
                                <option value="">Todos os Coordenadores</option>
                            </select>
                            <button type="submit">Filtrar</button>
                        </form>
                        <table>
                            <thead>
                                <tr id="green">
                                    <th>Título</th>
                                    <th>Temática</th>
                                    <th>Coordenador</th>
                                </tr>
                            </thead>
                            <tbody id="portifolio-tbody">
                            </tbody>
                        </table>
                        <div id="pagination-portifolio">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="chart-container">
            <h2>Projetos por Temática</h2>
            <canvas id="graficoTematicas"></canvas>
        </div>
        <div style="display: flex;">
            <div class="chart-container">
                <canvas id="graficoPizzaTematicas"></canvas>
            </div>
            <div class="chart-container">
                <h2>Projetos por Coordenador</h2>
                <canvas id="graficoPizzaCoordenadores"></canvas>
            </div>
        </div>
        <!----------------- Contato ------------>
        <div id="contact">

            <h1 class="sub-title-type-2">Contato do Agente de Inovação do IFNMG Salinas</h1>
            <p><i class="fa-solid fa-paper-plane"></i> luisphelps671@gmail.com</p>
            <p><i class="fa-brands fa-square-whatsapp"></i> 38 988643820</p>
            <div class="social-icons">
                <a href="https://www.facebook.com/profile.php?id=100008665060845"><i
                        class="fa-brands fa-facebook"></i></a>
                <a href="#"><i class="fa-brands fa-twitter"></i></a>
                <a href="https://www.instagram.com/luis_f3lps/"><i class="fa-brands fa-instagram"></i></a>
                <a href="https://www.linkedin.com/in/luis-gustavo-barbosa-santiago-648395280/"><i
                        class="fa-brands fa-linkedin"></i></a>

            </div>
        </div>
    </div>


    <script>
        // Paleta de cores para o gráfico de Coordenadores
        const PALETA_CORES_COORDENADORES = [
            'rgba(21, 67, 96, 0.9)',     // 1. Azul Petróleo Escuro
            'rgba(27, 79, 114, 0.9)',
            'rgba(33, 97, 140, 0.9)',
            'rgba(21, 101, 192, 0.85)',  // 4. Azul Escuro
            'rgba(25, 118, 210, 0.85)',
            'rgba(30, 136, 229, 0.85)',
            'rgba(33, 150, 243, 0.85)',  // 7. Azul Padrão
            'rgba(66, 165, 245, 0.8)',
            'rgba(100, 181, 246, 0.8)',
            'rgba(144, 202, 249, 0.8)',  // 10. Azul Claro
            'rgba(174, 214, 241, 0.8)',
            'rgba(187, 222, 251, 0.8)',
            'rgba(212, 230, 241, 0.8)',
            'rgba(229, 239, 247, 0.8)',
            'rgba(235, 245, 251, 0.8)',
            'rgba(240, 248, 255, 0.8)',  // 16. Alice Blue
            'rgba(245, 249, 253, 0.8)'   // 17. Azul Gelo (para "Outros")
        ];

        // Paleta de cores diferente para o gráfico de Temáticas
        const PALETA_CORES_TEMATICAS = [
            'rgba(211, 47, 47, 0.9)',    // 1. Vermelho Escuro
            'rgba(231, 94, 24, 0.9)',    // 2. Vermelho Claro
            'rgba(251, 140, 0, 0.9)',    // 3. Laranja
            'rgba(255, 167, 38, 0.9)',   // 4. Âmbar
            'rgba(255, 193, 7, 0.9)',    // 5. Amarelo Laranja
            'rgba(253, 216, 53, 0.9)',   // 6. Amarelo
            'rgba(205, 220, 57, 0.9)',   // 7. Lima
            'rgba(139, 195, 74, 0.9)',   // 8. Verde Limão
            'rgba(76, 175, 80, 0.9)',    // 9. Verde
            'rgba(0, 150, 136, 0.9)',    // 10. Verde-azulado (Teal)
        ];

        // Gráfico 1: Coordenadores
        async function criarGraficoPizzaCoordenadores() {
            try {
                const response = await fetch('/api/stats/coordenadores');
                if (!response.ok) throw new Error('Falha ao buscar dados dos coordenadores');
                const data = await response.json();

                const LIMITE_PRINCIPAIS = 16;
                let labelsProcessados = [];
                let valuesProcessados = [];

                const dataNumerica = data.map(item => ({
                    ...item,
                    total_projetos: parseInt(item.total_projetos, 10)
                }));

                if (dataNumerica.length > LIMITE_PRINCIPAIS) {
                    const principais = dataNumerica.slice(0, LIMITE_PRINCIPAIS);
                    labelsProcessados = principais.map(item => item.nome_coordenador);
                    valuesProcessados = principais.map(item => item.total_projetos);

                    const outros = dataNumerica.slice(LIMITE_PRINCIPAIS);
                    const somaOutros = outros.reduce((soma, item) => soma + item.total_projetos, 0);

                    if (somaOutros > 0) {
                        labelsProcessados.push('Outros');
                        valuesProcessados.push(somaOutros);
                    }
                } else {
                    labelsProcessados = dataNumerica.map(item => item.nome_coordenador);
                    valuesProcessados = dataNumerica.map(item => item.total_projetos);
                }

                const totalProjetos = valuesProcessados.reduce((soma, valor) => soma + valor, 0);
                const ctx = document.getElementById('graficoPizzaCoordenadores').getContext('2d');

                new Chart(ctx, {
                    type: 'pie',
                    data: {
                        labels: labelsProcessados,
                        datasets: [{
                            label: 'Projetos',
                            data: valuesProcessados,
                            backgroundColor: PALETA_CORES_COORDENADORES,
                            borderColor: '#fff',
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: { position: 'right' },
                            title: {
                                display: true,
                                text: 'Projetos por Coordenador',
                                font: { size: 48 },
                                position: 'top',
                                align: 'start'
                            },
                            tooltip: {
                                callbacks: {
                                    label: function (context) {
                                        const label = context.label || '';
                                        const value = context.raw;
                                        const percentage = ((value / totalProjetos) * 100).toFixed(1);
                                        return `${label}: ${value} projetos (${percentage}%)`;
                                    }
                                }
                            }
                        }
                    }
                });
            } catch (error) {
                console.error("Erro ao criar o gráfico de coordenadores:", error);
                const container = document.getElementById('graficoPizzaCoordenadores').parentElement;
                if (container) container.innerHTML = "Não foi possível carregar o gráfico.";
            }
        }

        // Gráfico 2: Temáticas
        async function criarGraficoPizzaTematicas() {
            try {
                const response = await fetch('/api/stats/tematicas');
                if (!response.ok) throw new Error('Falha ao buscar dados de temáticas');
                const data = await response.json();

                const labels = data.map(item => item.tematica);
                const values = data.map(item => parseInt(item.total_projetos, 10));
                const totalProjetos = values.reduce((sum, current) => sum + current, 0);

                const ctx = document.getElementById('graficoPizzaTematicas').getContext('2d');

                new Chart(ctx, {
                    type: 'pie',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'Projetos',
                            data: values,
                            backgroundColor: PALETA_CORES_TEMATICAS,
                            borderColor: '#fff',
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: { position: 'right' },
                            title: {
                                display: true,
                                text: 'Projetos por Área Temática',
                                font: { size: 48 },
                                position: 'top',
                                align: 'start'
                            },
                            tooltip: {
                                callbacks: {
                                    label: function (context) {
                                        const label = context.label || '';
                                        const value = context.raw;
                                        const percentage = ((value / totalProjetos) * 100).toFixed(1);
                                        return `${label}: ${value} projetos (${percentage}%)`;
                                    }
                                }
                            }
                        }
                    }
                });
            } catch (error) {
                console.error("Erro ao criar o gráfico de temáticas:", error);
                const container = document.getElementById('graficoPizzaTematicas').parentElement;
                if (container) container.innerHTML = "Não foi possível carregar o gráfico.";
            }
        }

        // Chamar as funções dos gráficos quando a página carregar
        document.addEventListener('DOMContentLoaded', () => {
            criarGraficoPizzaCoordenadores();
            criarGraficoPizzaTematicas();
            criarGraficoTematicas();
        });

        async function criarGraficoTematicas() {
            try {
                // Simulando a chamada à API
                const response = await fetch('/api/stats/tematicas');
                const data = await response.json();

                const labels = data.map(item => item.tematica);
                const values = data.map(item => item.total_projetos);

                const ctx = document.getElementById('graficoTematicas').getContext('2d');

                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'Quantidade de Projetos',
                            data: values,
                            backgroundColor: 'rgba(54, 162, 235, 0.6)',
                            borderColor: 'rgba(54, 162, 235, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        // OPÇÕES ATUALIZADAS
                        responsive: true,
                        maintainAspectRatio: false, // Correção principal!
                        scales: {
                            y: { beginAtZero: true, ticks: { stepSize: 1 } }
                        }
                    }
                });

            } catch (error) {
                console.error("Erro ao criar o gráfico:", error);
            }
        }

    </script>

    <script>
        var sidemenu = document.getElementById("sidemenu");
        function openmenu() {
            sidemenu.style.right = "-200px";
            sidemenu.style.left = "0px";
        }
        function clossmenu() {
            sidemenu.style.left = "-800px";
        }
    </script>
    <script src="js/index.js"></script>

</body>

</html>